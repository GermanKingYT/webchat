@model webchat.Models.Rooms

@using webchat.Helpers;

@if(!ViewData.ModelState.IsValid){
    var errors = ViewData.ModelState.Values.SelectMany(v => v.Errors).Select(t => t.ErrorMessage);
    @Html.ErrorSummary("errors", errors.ToList(), null, new { @class = "alert alert-error"});
    return;
}

<div id="error-dialog" title="Connection error!" hidden="hidden">
<p>A connection error occured, please reconnect!</p>
</div>

<div class="chat-window" id="chat">
</div>

<span class="pull-right actionbox-toolbar">
    <a href="#" title="Toggle the actionbox">
        <i id='toggler' class="icon-resize-small"></i></a>&nbsp;
</span>

<div class="well well-small" id="actionbox">
    @using(Html.BeginForm("Index", "Chat", FormMethod.Post)) {
        @Html.Label("text", (string)Session["nick"])
        @Html.TextBox("text", null, new { tabindex = 1 })

        <input type="submit" class="btn btn-primary" tabindex="2" id="send" name="send" value="Send!"/>
        
        @Html.Label("join_rooms", Resources.Strings.JoinRoomsLabel)
        @Html.TextBox("join_rooms", null, new { tabindex = 3 })

        <input id="join" name="join" tabindex="4" type="submit" value="Join!" />
        <br />
        <br />
        <input class="btn btn-danger" id="quit" name="quit" tabindex="5" type="submit" value="Quit!" />
        
        @Html.Hidden("rooms", Json.Encode(Model))
    }
</div>

<script type=text/javascript>
    $SCRIPT_ROOT = "TODO";
    @{ //TODO: api/....
    }
     
    users = "users";
    @{ //TODO: get this out of the model
    }
</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"
    type="text/javascript"></script>

<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/jquery-ui.min.js"
    type="text/javascript"></script>

<script type="text/javascript" src="@Url.Content("~/Static/bootstrap/js/bootstrap.js")"></script>

<script type="text/javascript" src="@Url.Content("~/Static/Js/notificon.min.js")"></script>

<script type="text/javascript" src="@Url.Content("~/Static/Js/jquery.caret.min.js")"></script>

<script type="text/javascript" src="@Url.Content("~/Static/Js/chat.js")"></script>